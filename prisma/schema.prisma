datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id               String         @id @default(uuid())
    roleId           String
    role             Role           @relation(fields: [roleId], references: [id])
    gender           String
    firstname        String
    lastname         String
    email            String         @unique
    emailVerifiedAt  DateTime?
    password         String
    phone            String
    modelType        String
    hasMobileAccess  Boolean
    profilePhotoPath String?
    lastLoginAt      DateTime?
    lastLoginIp      String?
    refreshToken     RefreshToken[]
    createdAt        DateTime       @default(now())
    updatedAt        DateTime       @updatedAt
    Customer         Customer[]

    @@map("users")
}

model Role {
    id          String       @id @default(uuid())
    name        String       @unique
    users       User[]
    permissions Permission[]
    createdAt   DateTime     @default(now())
    updatedAt   DateTime     @updatedAt

    @@map("roles")
}

model Permission {
    id        String   @id @default(uuid())
    name      String   @unique
    roleId    String
    role      Role     @relation(fields: [roleId], references: [id])
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("permissions")
}

model RefreshToken {
    id        String   @id @default(uuid())
    token     String   @unique
    userId    String
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
    expiresAt DateTime
    createdAt DateTime @default(now())

    @@map("refresh_token")
}

model Customer {
    id                   Int      @id @default(autoincrement())
    number               String
    type                 String
    gender               String?
    firstname            String?
    lastname             String?
    company_name         String?
    company_fj           String?
    company_ice          String?
    phone                String
    email                String
    adresse              String
    postal_code          String
    city                 String
    country              String
    adresse_shipping     String?
    postal_code_shipping String?
    city_shipping        String?
    country_shipping     String?
    statut               String
    created_by           String
    creator              User     @relation(fields: [created_by], references: [id])
    createdAt            DateTime @default(now())
    updatedAt            DateTime @updatedAt

    @@map("customers")
}
